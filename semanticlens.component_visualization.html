<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="semanticlens.foundation_models package" href="semanticlens.foundation_models.html" /><link rel="prev" title="semanticlens package" href="semanticlens.html" />
        <link rel="prefetch" href="_static/logo-small.svg" as="image" />
        <link rel="prefetch" href="_static/logo-small.svg" as="image" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.07.19 -->
        <title>semanticlens.component_visualization package - SemanticLens v0.1.2</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=49ab6432" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #2563eb;
  --color-brand-content: #2563eb;
  --color-admonition-background: transparent;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #60a5fa;
  --color-brand-content: #60a5fa;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #60a5fa;
  --color-brand-content: #60a5fa;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">SemanticLens v0.1.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo-small.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo-small.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SemanticLens v0.1.2</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">semanticlens</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of semanticlens</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="semanticlens.html">semanticlens package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of semanticlens package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">semanticlens.component_visualization package</a></li>
<li class="toctree-l3"><a class="reference internal" href="semanticlens.foundation_models.html">semanticlens.foundation_models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="semanticlens.utils.html">semanticlens.utils package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to SemanticLens</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/jim-berend/semanticlens/blob/main/docs/source/semanticlens.component_visualization.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/jim-berend/semanticlens/edit/main/docs/source/semanticlens.component_visualization.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="semanticlens-component-visualization-package">
<h1>semanticlens.component_visualization package<a class="headerlink" href="#semanticlens-component-visualization-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-semanticlens.component_visualization.activation_based">
<span id="semanticlens-component-visualization-activation-based-module"></span><h2>semanticlens.component_visualization.activation_based module<a class="headerlink" href="#module-semanticlens.component_visualization.activation_based" title="Link to this heading">¶</a></h2>
<p>Activation-based component visualization for neural network analysis.</p>
<p>This module provides the <cite>ActivationComponentVisualizer</cite>, a tool for identifying
the concept examples that most strongly activate specific components (e.g., neurons,
channels) of a neural network. It works by performing a forward pass over a dataset,
caching the activations for specified layers, and identifying the top-k activating
input samples for each component.
For component visualization the full act-max samples are returned.</p>
<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.activation_based.</span></span><span class="sig-name descname"><span class="pre">ActivationComponentVisualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer" title="semanticlens.component_visualization.base.AbstractComponentVisualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponentVisualizer</span></code></a></p>
<p>Finds and visualizes concepts based on activation maximization.</p>
<p>This class implements the activation-based approach to component
visualization. It processes a dataset to find the input examples that
produce the highest activation values for each component within specified
layers of a neural network.</p>
<p>The results, including the indices of the top-activating samples, are
cached to disk for efficient re-use in subsequent analyses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><em>torch.nn.Module</em></a>) – The neural network model to analyze. It is recommended that the model
has a <cite>.name</cite> attribute for reliable caching.</p></li>
<li><p><strong>dataset_model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – The dataset used for model inference to find top-activating samples.
It should be preprocessed as required by the model. It is recommended
that the dataset has a <cite>.name</cite> attribute for reliable caching.</p></li>
<li><p><strong>dataset_fm</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – The dataset preprocessed for the foundation model. This version should
yield raw data (e.g., PIL Images) that the foundation model’s own
preprocessor can handle.</p></li>
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – A list of names of the layers to analyze (e.g., <cite>[‘layer4.1.conv2’]</cite>).</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of top-activating samples to collect for each component.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The device on which to perform computations. If None, the model’s
current device is used.</p></li>
<li><p><strong>aggregate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function to aggregate the spatial or temporal dimensions of the layer
activations into a single value per component. If None, defaults to
taking the mean over spatial dimensions for convolutional layers.
(A selection of aggregation functions are provided in
<cite>semanticlens.component_visualization.aggregators</cite>.)</p></li>
<li><p><strong>cache_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – The root directory for caching results. If None, caching is disabled.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.actmax_cache">
<span class="sig-name descname"><span class="pre">actmax_cache</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.actmax_cache" title="Link to this definition">¶</a></dt>
<dd><p>An object that manages the collection and caching of top activations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache" title="semanticlens.component_visualization.activation_caching.ActMaxCache">ActMaxCache</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any layer name in <cite>layer_names</cite> is not found in the model.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">resnet18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">TensorDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">semanticlens.component_visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActivationComponentVisualizer</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1. Prepare model and dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;resnet18&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_data</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dummy_data&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2. Initialize the visualizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">visualizer</span> <span class="o">=</span> <span class="n">ActivationComponentVisualizer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dataset_model</span><span class="o">=</span><span class="n">dummy_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dataset_fm</span><span class="o">=</span><span class="n">dummy_data</span><span class="p">,</span> <span class="c1"># Using same dataset for simplicity here</span>
<span class="gp">... </span>    <span class="n">layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;layer4.1.conv2&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cache_dir</span><span class="o">=</span><span class="s2">&quot;./cache&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3. Run the analysis to find top-activating samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will process the dataset and save the results to the cache.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># visualizer.run(batch_size=32)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.AGGREGATION_DEFAULTS">
<span class="sig-name descname"><span class="pre">AGGREGATION_DEFAULTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'max':</span> <span class="pre">&lt;function</span> <span class="pre">aggregate_conv_max&gt;,</span> <span class="pre">'mean':</span> <span class="pre">&lt;function</span> <span class="pre">aggregate_conv_mean&gt;}</span></em><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.AGGREGATION_DEFAULTS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the ActivationComponentVisualizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><em>torch.nn.Module</em></a>) – The neural network model to analyze.</p></li>
<li><p><strong>dataset_model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – Dataset for model inference and activation collection.</p></li>
<li><p><strong>dataset_fm</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – Dataset preprocessed for foundation model encoding.</p></li>
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Names of the layers to analyze for component visualization.</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of top activating samples to collect per component.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Device for computations. If None, uses model’s device.</p></li>
<li><p><strong>aggregate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function for aggregating activations. If None, uses default conv mean aggregation.</p></li>
<li><p><strong>cache_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Directory for caching results. If None, results will not be cached.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any layer in layer_names is not found in the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.caching">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">caching</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.caching" title="Link to this definition">¶</a></dt>
<dd><p>Check if caching is enabled.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.device" title="Link to this definition">¶</a></dt>
<dd><p>Get the device of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device where the model parameters are located.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)">torch.device</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.get_max_reference">
<span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.get_max_reference" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating samples for a layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer to get sample IDs for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape (n_components, n_samples) containing the dataset
indices of maximally activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Get metadata about the visualization instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing metadata about the cache, dataset, and model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the activation maximization analysis on the dataset.</p>
<p>This method processes the entire <cite>dataset_model</cite> to find the maximally
activating input examples for each component in the specified layers.
If a valid cache is found, the results are loaded directly from disk,
skipping the computation. Otherwise, the computation is performed and
the results are saved to the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=32</em>) – The batch size to use for processing the dataset.</p></li>
<li><p><strong>num_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – The number of worker processes for the data loader.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping layer names to <cite>ActMax</cite> instances, which
contain the top activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.storage_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storage_dir</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.storage_dir" title="Link to this definition">¶</a></dt>
<dd><p>Get the directory for storing concept visualization cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the storage directory for this visualizer instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)">pathlib.Path</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If no cache directory was provided during initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.to" title="Link to this definition">¶</a></dt>
<dd><p>Move the model to the specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The target device to move the model to.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model after being moved to the specified device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)">torch.nn.Module</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.visualize_components">
<span class="sig-name descname"><span class="pre">visualize_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denormalization_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.visualize_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.visualize_components" title="Link to this definition">¶</a></dt>
<dd><p>Visualize specific components by displaying their top activating samples.</p>
<p>A good place to put it here since we need access to the PIL-dataset and actmax cache to implement this. However we should call a stateless function in here that abstracts complexity and can be used by other versions of the concept visualizer as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component_ids</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – IDs of the components to visualize.</p></li>
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer containing the components.</p></li>
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=9</em>) – Number of top activating samples to display per component.</p></li>
<li><p><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=3</em>) – Number of rows in the grid layout for each component.</p></li>
<li><p><strong>denormalization_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function to denormalize the images before visualization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_based.MissingNameWarning">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.activation_based.</span></span><span class="sig-name descname"><span class="pre">MissingNameWarning</span></span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#MissingNameWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_based.MissingNameWarning" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserWarning</span></code></a></p>
<p>Warning raised when a model or dataset is missing a <cite>.name</cite> attribute.</p>
<p>This attribute is crucial for the caching mechanism to create a stable and predictable cache location.
Without it, a fallback name is generated.</p>
</dd></dl>

</section>
<section id="module-semanticlens.component_visualization.activation_caching">
<span id="semanticlens-component-visualization-activation-caching-module"></span><h2>semanticlens.component_visualization.activation_caching module<a class="headerlink" href="#module-semanticlens.component_visualization.activation_caching" title="Link to this heading">¶</a></h2>
<p>Helpers to collect, aggregate, and cache activations in PyTorch.</p>
<p>This module provides classes for efficiently collecting, aggregating, and
caching neural network activations during inference. It is designed to be
flexible and robust, supporting custom aggregation logic and providing an
object-oriented API for saving and loading the cache.</p>
<p>The main classes are <cite>ActMax</cite>, which stores the top-k activations for a single
layer, and <cite>ActMaxCache</cite>, which manages the process of hooking into a model and
populating <cite>ActMax</cite> instances for multiple layers.</p>
<section id="workflow-example">
<h3>Workflow Example<a class="headerlink" href="#workflow-example" title="Link to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">TensorDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">resnet18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">semanticlens.component_visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">aggregators</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">semanticlens.component_visualization.activation_caching</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActMaxCache</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">resnet18</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;layer4.1.conv2&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1. Instantiate the cache.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span> <span class="o">=</span> <span class="n">ActMaxCache</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">layer_names</span><span class="o">=</span><span class="n">layer_names</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">aggregation_fn</span><span class="o">=</span><span class="n">aggregators</span><span class="o">.</span><span class="n">aggregate_conv_mean</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">n_collect</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2. Run the model within the hook context to collect activations.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">cache</span><span class="o">.</span><span class="n">hook_context</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3. Save the populated cache to disk.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./my_cache&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.activation_caching.</span></span><span class="sig-name descname"><span class="pre">ActCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActCache" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class to collect raw activations from model layers via forward hooks.</p>
<p>This class provides the fundamental infrastructure for registering forward hooks
on specified model layers and collecting their activations during inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Names of the model layers to hook and collect activations from.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActCache.layer_names">
<span class="sig-name descname"><span class="pre">layer_names</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActCache.layer_names" title="Link to this definition">¶</a></dt>
<dd><p>Names of the layers being monitored.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActCache.cache">
<span class="sig-name descname"><span class="pre">cache</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActCache.cache" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary storing collected activations by layer name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActCache.handles">
<span class="sig-name descname"><span class="pre">handles</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActCache.handles" title="Link to this definition">¶</a></dt>
<dd><p>List of hook handles for proper cleanup.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[torch.utils.hooks.RemovableHandle]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActCache.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActCache.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActCache.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActCache.hook_context">
<span class="sig-name descname"><span class="pre">hook_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActCache.hook_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActCache.hook_context" title="Link to this definition">¶</a></dt>
<dd><p>Context manager to automatically register and remove hooks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><em>torch.nn.Module</em></a>) – The model to register hooks on.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em> – Context for running model inference with hooks active.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This context manager ensures that hooks are properly cleaned up
even if an exception occurs during inference.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.activation_caching.</span></span><span class="sig-name descname"><span class="pre">ActMax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_collect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_latents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Tool for collecting and storing the top-k maximal activations.</p>
<p>This class can be initialized with all dimensions known or can infer the
number of latent dimensions from the first batch of data it receives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_collect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of top activations to collect and store.</p></li>
<li><p><strong>n_latents</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of latent dimensions (e.g., channels, neurons). If None,
will be inferred from the first batch of data.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.n_collect">
<span class="sig-name descname"><span class="pre">n_collect</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.n_collect" title="Link to this definition">¶</a></dt>
<dd><p>Number of top activations being collected.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.n_latents">
<span class="sig-name descname"><span class="pre">n_latents</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.n_latents" title="Link to this definition">¶</a></dt>
<dd><p>Number of latent dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.is_setup">
<span class="sig-name descname"><span class="pre">is_setup</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.is_setup" title="Link to this definition">¶</a></dt>
<dd><p>Whether the internal tensors have been initialized.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.activations">
<span class="sig-name descname"><span class="pre">activations</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.activations" title="Link to this definition">¶</a></dt>
<dd><p>Tensor storing the top activation values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.sample_ids">
<span class="sig-name descname"><span class="pre">sample_ids</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.sample_ids" title="Link to this definition">¶</a></dt>
<dd><p>Tensor storing the sample IDs corresponding to top activations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_collect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_latents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMax.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.alive_latents">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alive_latents</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.alive_latents" title="Link to this definition">¶</a></dt>
<dd><p>Return indices of latents with any non-zero activation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Indices of latent dimensions that have non-zero activations.
Empty tensor if the instance is not set up.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMax.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.load" title="Link to this definition">¶</a></dt>
<dd><p>Load an ActMax instance from a safetensors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em>) – Path to the safetensors file to load.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded ActMax instance with data from the file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax" title="semanticlens.component_visualization.activation_caching.ActMax">ActMax</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the file is missing required metadata for loading.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMax.store"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.store" title="Link to this definition">¶</a></dt>
<dd><p>Store tensors and metadata to a safetensors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em>) – Path where the data should be saved.</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – Additional metadata to store with the tensors.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the instance is not set up, the method will log a warning and skip storage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMax.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMax.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMax.update" title="Link to this definition">¶</a></dt>
<dd><p>Update activations with a new batch, setting up tensors on first call if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acts</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Activation tensor with shape (batch_size, n_latents).</p></li>
<li><p><strong>sample_ids</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Sample IDs corresponding to the activations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If this is the first call and tensors haven’t been set up, the number
of latents will be inferred from the activation tensor shape.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.activation_caching.</span></span><span class="sig-name descname"><span class="pre">ActMaxCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_collect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache" title="semanticlens.component_visualization.activation_caching.ActCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActCache</span></code></a></p>
<p>Collects, aggregates, and finds the top-k activations for specified layers.</p>
<p>This class extends ActCache to not only collect activations but also aggregate
them using a specified function and maintain only the top-k activating samples
for each component in each layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Names of the model layers to analyze.</p></li>
<li><p><strong>aggregation_fn</strong> (<em>callable</em>) – Function to aggregate activations (e.g., mean over spatial dimensions).
Must be a named function, not a lambda.</p></li>
<li><p><strong>n_collect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of top activating samples to collect per component.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.aggregation_fn">
<span class="sig-name descname"><span class="pre">aggregation_fn</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.aggregation_fn" title="Link to this definition">¶</a></dt>
<dd><p>The aggregation function being used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.n_collect">
<span class="sig-name descname"><span class="pre">n_collect</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.n_collect" title="Link to this definition">¶</a></dt>
<dd><p>Number of samples collected per component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.sample_idx_counter">
<span class="sig-name descname"><span class="pre">sample_idx_counter</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.sample_idx_counter" title="Link to this definition">¶</a></dt>
<dd><p>Counter for tracking sample indices during data processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.agg_fn_name">
<span class="sig-name descname"><span class="pre">agg_fn_name</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.agg_fn_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of the aggregation function for metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.cache">
<span class="sig-name descname"><span class="pre">cache</span></span><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.cache" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary mapping layer names to ActMax instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax" title="semanticlens.component_visualization.activation_caching.ActMax">ActMax</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the aggregation function is a lambda or has no name.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__getitem__" title="Link to this definition">¶</a></dt>
<dd><p>Get the ActMax instance for a specific layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The ActMax instance associated with the specified layer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax" title="semanticlens.component_visualization.activation_caching.ActMax">ActMax</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_collect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache.__iter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__iter__" title="Link to this definition">¶</a></dt>
<dd><p>Return an iterator over the ActMax instances in the cache.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__repr__" title="Link to this definition">¶</a></dt>
<dd><p>Return string representation of the ActMaxCache instance.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.load" title="Link to this definition">¶</a></dt>
<dd><p>Load data into this cache instance from a directory.</p>
<p>This method will only load files that match the instance’s configured
aggregation function and <cite>n_collect</cite> value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The directory containing the <cite>.safetensors</cite> files.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the directory does not exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If no matching cache files are found or if file metadata doesn’t match.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Returns metadata about the cache instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.activation_caching.ActMaxCache.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_caching.html#ActMaxCache.store"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.store" title="Link to this definition">¶</a></dt>
<dd><p>Save the cache to a directory.</p>
<p>Each layer’s data is saved to a separate <cite>.safetensors</cite> file named
<cite>{layer_name}.{aggregation_function_name}.safetensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Directory where cache files will be saved.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-semanticlens.component_visualization.aggregators">
<span id="semanticlens-component-visualization-aggregators-module"></span><h2>semanticlens.component_visualization.aggregators module<a class="headerlink" href="#module-semanticlens.component_visualization.aggregators" title="Link to this heading">¶</a></h2>
<p>Aggregation functions for neural network activations.</p>
<p>This module provides various aggregation functions for reducing tensor dimensions
in neural network activations. These functions are used to summarize activations
across spatial or temporal dimensions for further analysis.</p>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>aggregate_conv_mean<span class="classifier">callable</span></dt><dd><p>Aggregates 4D convolutional tensors by taking the mean over spatial dimensions.</p>
</dd>
<dt>aggregate_conv_max<span class="classifier">callable</span></dt><dd><p>Aggregates 4D convolutional tensors by taking the max over spatial dimensions.</p>
</dd>
<dt>aggregate_transformer_mean<span class="classifier">callable</span></dt><dd><p>Aggregates 3D transformer tensors by taking the mean over token dimension.</p>
</dd>
<dt>aggregate_transformer_absmean<span class="classifier">callable</span></dt><dd><p>Aggregates 3D transformer tensors by taking the mean of absolute values over token dimension.</p>
</dd>
<dt>aggregate_transformer_max<span class="classifier">callable</span></dt><dd><p>Aggregates 3D transformer tensors by taking the max over token dimension.</p>
</dd>
<dt>aggregate_transformer_absmax<span class="classifier">callable</span></dt><dd><p>Aggregates 3D transformer tensors by taking the max of absolute values over token dimension.</p>
</dd>
<dt>get_aggregate_transformer_special_token<span class="classifier">callable</span></dt><dd><p>Returns a function that extracts values at a specific token position.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function names are involved during caching and should be kept consistent.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.aggregate_conv_max">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">aggregate_conv_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#aggregate_conv_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.aggregate_conv_max" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate a 4D convolutional tensor by taking the max over spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input 4D tensor with shape (batch, channels, height, width).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated tensor with shape (batch, channels) on CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If input tensor is not 4-dimensional.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.aggregate_conv_mean">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">aggregate_conv_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#aggregate_conv_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.aggregate_conv_mean" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate a 4D convolutional tensor by taking the mean over spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input 4D tensor with shape (batch, channels, height, width).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated tensor with shape (batch, channels) on CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If input tensor is not 4-dimensional.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.aggregate_transformer_absmax">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">aggregate_transformer_absmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#aggregate_transformer_absmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_absmax" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate a 3D transformer tensor by taking the max of absolute values over the token dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input 3D tensor with shape (batch, tokens, features).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated tensor with shape (batch, features) on CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If input tensor is not 3-dimensional.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.aggregate_transformer_absmean">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">aggregate_transformer_absmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#aggregate_transformer_absmean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_absmean" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate a 3D transformer tensor by taking the mean of absolute values over the token dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input 3D tensor with shape (batch, tokens, features).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated tensor with shape (batch, features) on CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If input tensor is not 3-dimensional.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.aggregate_transformer_max">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">aggregate_transformer_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#aggregate_transformer_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_max" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate a 3D transformer tensor by taking the max over the token dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input 3D tensor with shape (batch, tokens, features).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated tensor with shape (batch, features) on CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If input tensor is not 3-dimensional.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.aggregate_transformer_mean">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">aggregate_transformer_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#aggregate_transformer_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_mean" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate a 3D transformer tensor by taking the mean over the token dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input 3D tensor with shape (batch, tokens, features).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated tensor with shape (batch, features) on CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If input tensor is not 3-dimensional.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="semanticlens.component_visualization.aggregators.get_aggregate_transformer_special_token">
<span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.aggregators.</span></span><span class="sig-name descname"><span class="pre">get_aggregate_transformer_special_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/aggregators.html#get_aggregate_transformer_special_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.aggregators.get_aggregate_transformer_special_token" title="Link to this definition">¶</a></dt>
<dd><p>Return a function that aggregates a 3D tensor by extracting values at a specific token position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token_position</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The position of the token to extract values from.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A function that takes a 3D tensor and returns values at the specified token position.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">agg_fn</span> <span class="o">=</span> <span class="n">get_aggregate_transformer_special_token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Extract CLS token</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">agg_fn</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>  <span class="c1"># tensor shape: (batch, tokens, features)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-semanticlens.component_visualization.base">
<span id="semanticlens-component-visualization-base-module"></span><h2>semanticlens.component_visualization.base module<a class="headerlink" href="#module-semanticlens.component_visualization.base" title="Link to this heading">¶</a></h2>
<p>Abstract base class for component visualizers.</p>
<p>This module defines the interface that all component visualizers must implement,
providing consistent methods for analyzing neural network components across
different visualization approaches.</p>
<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.base.</span></span><span class="sig-name descname"><span class="pre">AbstractComponentVisualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/base.html#AbstractComponentVisualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract base class for all component visualizers.</p>
<p>A component visualizer is responsible for identifying the “concepts”
that a model’s components (e.g., neurons, channels) have learned.
This is typically done by analyzing how the components respond to a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><em>torch.nn.Module</em></a>) – The neural network model to analyze.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em>, </em><em>optional</em>) – Device for computations. If None, uses the model’s current device.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.model" title="Link to this definition">¶</a></dt>
<dd><p>The neural network model being analyzed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)">torch.nn.Module</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.device" title="Link to this definition">¶</a></dt>
<dd><p>The device where computations are performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)">torch.device</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/base.html#AbstractComponentVisualizer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.caching">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">caching</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.caching" title="Link to this definition">¶</a></dt>
<dd><p>Check if caching is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if caching is enabled, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Get the device on which the model is located.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device where the model parameters are located.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)">torch.device</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.get_max_reference">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/base.html#AbstractComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.get_max_reference" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating samples for a layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer to get sample IDs for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape (n_components, n_samples) containing the dataset
indices of maximally activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Get metadata about the visualization instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing metadata about the visualizer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.run">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/base.html#AbstractComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the concept identification process on a given dataset.</p>
<p>This method should process the dataset to gather the necessary
information for identifying concepts encoded by the model-components,
such as finding the top-activating samples for each component and caching them for later use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments for the analysis process, such as a <cite>dataset</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the analysis process, such as
<cite>batch_size</cite> or <cite>num_workers</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.storage_dir">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storage_dir</span></span><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.storage_dir" title="Link to this definition">¶</a></dt>
<dd><p>Get the directory for storing concept visualization cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the directory where cache files are stored.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)">pathlib.Path</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.base.AbstractComponentVisualizer.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/base.html#AbstractComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.to" title="Link to this definition">¶</a></dt>
<dd><p>Move the visualizer and its model to the specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a>) – The target device to move the model to.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer" title="semanticlens.component_visualization.base.AbstractComponentVisualizer">AbstractComponentVisualizer</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-semanticlens.component_visualization.relevance_based">
<span id="semanticlens-component-visualization-relevance-based-module"></span><h2>semanticlens.component_visualization.relevance_based module<a class="headerlink" href="#module-semanticlens.component_visualization.relevance_based" title="Link to this heading">¶</a></h2>
<p>Relevance-based component visualization using attribution methods.</p>
<p>This module provides tools for visualizing neural network components using
Layer-wise Relevance Propagation (LRP) and Concept Relevance Propagation (CRP)
attribution methods to understand which input features are most relevant for
specific neural activations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.relevance_based.</span></span><span class="sig-name descname"><span class="pre">RelevanceComponentVisualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_fn='sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_norm=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dir='FeatureVisualization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fn=&lt;function</span> <span class="pre">crop_and_mask_images&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureVisualization</span></code>, <a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer" title="semanticlens.component_visualization.base.AbstractComponentVisualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponentVisualizer</span></code></a></p>
<p>Component visualizer using relevance-based attribution methods.</p>
<p>This class extends the FeatureVisualization from CRP (Concept Relevance Propagation)
to provide relevance-based analysis of neural network components. It uses attribution
methods like LRP to understand which input features contribute most to specific
neural activations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribution</strong> (<em>crp.attribution.Attributor</em>) – Attribution method for computing relevance scores.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – Dataset containing input examples for analysis.</p></li>
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Names of the layers to analyze.</p></li>
<li><p><strong>preprocess_fn</strong> (<em>callable</em>) – Function for preprocessing input data.</p></li>
<li><p><strong>composite</strong> (<em>zennit.composites.Composite</em><em>, </em><em>optional</em>) – Composite rule for attribution computation.</p></li>
<li><p><strong>aggregation_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;sum&quot;</em>) – Function for aggregating relevance scores.</p></li>
<li><p><strong>abs_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – Whether to use absolute normalization.</p></li>
<li><p><strong>storage_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;FeatureVisualization&quot;</em>) – Directory for storing visualization results.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Device for computations.</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=100</em>) – Number of samples to analyze per component.</p></li>
<li><p><strong>cache</strong> (<em>optional</em>) – Caching configuration.</p></li>
<li><p><strong>plot_fn</strong> (<em>callable</em><em>, </em><em>default=crop_and_mask_images</em>) – Function for plotting/rendering visualizations.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.num_samples">
<span class="sig-name descname"><span class="pre">num_samples</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.num_samples" title="Link to this definition">¶</a></dt>
<dd><p>Number of samples per component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.composite">
<span class="sig-name descname"><span class="pre">composite</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.composite" title="Link to this definition">¶</a></dt>
<dd><p>Composite rule for attribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>zennit.composites.Composite</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.storage_dir">
<span class="sig-name descname"><span class="pre">storage_dir</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.storage_dir" title="Link to this definition">¶</a></dt>
<dd><p>Storage directory path.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.plot_fn">
<span class="sig-name descname"><span class="pre">plot_fn</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.plot_fn" title="Link to this definition">¶</a></dt>
<dd><p>Plotting function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.aggregation_fn">
<span class="sig-name descname"><span class="pre">aggregation_fn</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.aggregation_fn" title="Link to this definition">¶</a></dt>
<dd><p>Aggregation function name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.abs_norm">
<span class="sig-name descname"><span class="pre">abs_norm</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.abs_norm" title="Link to this definition">¶</a></dt>
<dd><p>Whether absolute normalization is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.ActMax">
<span class="sig-name descname"><span class="pre">ActMax</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.ActMax" title="Link to this definition">¶</a></dt>
<dd><p>Maximization handler for activation analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>crp.maximization.Maximization</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.ActStats">
<span class="sig-name descname"><span class="pre">ActStats</span></span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.ActStats" title="Link to this definition">¶</a></dt>
<dd><p>Statistics handler for activation analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>crp.statistics.Statistics</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composite=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_start=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_end=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint=500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">\*\*kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.run" title="Link to this definition">¶</a></dt>
<dd><p>Run relevance-based preprocessing and analysis.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.get_max_reference">
<span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concept_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.get_max_reference" title="Link to this definition">¶</a></dt>
<dd><p>Get reference examples using relevance attribution.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.check_if_preprocessed">
<span class="sig-name descname"><span class="pre">check_if_preprocessed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.check_if_preprocessed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.check_if_preprocessed" title="Link to this definition">¶</a></dt>
<dd><p>Check if preprocessing has been completed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.get_act_max_sample_ids">
<span class="sig-name descname"><span class="pre">get_act_max_sample_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_act_max_sample_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.get_act_max_sample_ids" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating examples.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.to" title="Link to this definition">¶</a></dt>
<dd><p>Move visualizer to specified device.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.Properties">
<span class="sig-name descname"><span class="pre">Properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.Properties" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">----------</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">metadata</span> <span class="pre">:</span> <span class="pre">dict</span></span></dt>
<dd><p>Metadata about the visualizer configuration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_fn='sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_norm=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dir='FeatureVisualization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fn=&lt;function</span> <span class="pre">crop_and_mask_images&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">check_if_preprocessed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.check_if_preprocessed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd><p>Check if preprocessing has been completed for all layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if all specified layers have been preprocessed, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">get_act_max_sample_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_act_max_sample_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating examples for a layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer to get sample IDs for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape (n_components, n_samples) containing the dataset
indices of maximally activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concept_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition">¶</a></dt>
<dd><p>Get reference examples using relevance attribution.</p>
<p>Computes relevance-based visualizations for specified concepts using
attribution methods to highlight the most relevant input features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concept_ids</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – IDs of concepts to visualize.</p></li>
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer containing the concepts.</p></li>
<li><p><strong>n_ref</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of reference examples to generate.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=32</em>) – Batch size for processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping concept IDs to their reference visualizations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.13)"><strong>AttributeError</strong></a> – If gradients are not enabled or CRP requirements are not met.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method requires gradients to be enabled for LRP/CRP computation.
The <cite>torch.enable_grad()</cite> decorator ensures this requirement is met.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></em><a class="headerlink" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Get metadata about the visualizer configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing configuration parameters for caching and
reproducibility, including preprocessing function, normalization
settings, aggregation function, storage directory, device,
number of samples, and plotting function.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd><p>Run relevance-based preprocessing and analysis.</p>
<p>Processes the dataset using attribution methods to compute relevance
scores and identify maximally activating examples for each component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>composite</strong> (<em>zennit.composites.Composite</em><em>, </em><em>optional</em>) – Composite rule for attribution computation. If None, uses the
composite from initialization.</p></li>
<li><p><strong>data_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Starting index in the dataset.</p></li>
<li><p><strong>data_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Ending index in the dataset. If None, processes entire dataset.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=32</em>) – Batch size for processing.</p></li>
<li><p><strong>checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=500</em>) – Interval for saving checkpoints during processing.</p></li>
<li><p><strong>on_device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Device for computation.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to parent run method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Results from preprocessing, or list of existing files if already preprocessed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a> or other</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition">¶</a></dt>
<dd><p>Move visualizer and attribution model to specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Target device for the visualizer and attribution model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-semanticlens.component_visualization">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-semanticlens.component_visualization" title="Link to this heading">¶</a></h2>
<p>Component visualization modules for semantic analysis.</p>
<p>This module provides different approaches for visualizing and analyzing
neural network components, including activation-based and relevance-based
visualization methods.</p>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>ActivationComponentVisualizer</dt><dd><p>Visualizer using activation maximization techniques.</p>
</dd>
<dt>RelevanceComponentVisualizer</dt><dd><p>Visualizer using relevance-based attribution methods.</p>
</dd>
</dl>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.</span></span><span class="sig-name descname"><span class="pre">ActivationComponentVisualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer" title="semanticlens.component_visualization.base.AbstractComponentVisualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponentVisualizer</span></code></a></p>
<p>Finds and visualizes concepts based on activation maximization.</p>
<p>This class implements the activation-based approach to component
visualization. It processes a dataset to find the input examples that
produce the highest activation values for each component within specified
layers of a neural network.</p>
<p>The results, including the indices of the top-activating samples, are
cached to disk for efficient re-use in subsequent analyses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><em>torch.nn.Module</em></a>) – The neural network model to analyze. It is recommended that the model
has a <cite>.name</cite> attribute for reliable caching.</p></li>
<li><p><strong>dataset_model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – The dataset used for model inference to find top-activating samples.
It should be preprocessed as required by the model. It is recommended
that the dataset has a <cite>.name</cite> attribute for reliable caching.</p></li>
<li><p><strong>dataset_fm</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – The dataset preprocessed for the foundation model. This version should
yield raw data (e.g., PIL Images) that the foundation model’s own
preprocessor can handle.</p></li>
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – A list of names of the layers to analyze (e.g., <cite>[‘layer4.1.conv2’]</cite>).</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of top-activating samples to collect for each component.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The device on which to perform computations. If None, the model’s
current device is used.</p></li>
<li><p><strong>aggregate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function to aggregate the spatial or temporal dimensions of the layer
activations into a single value per component. If None, defaults to
taking the mean over spatial dimensions for convolutional layers.
(A selection of aggregation functions are provided in
<cite>semanticlens.component_visualization.aggregators</cite>.)</p></li>
<li><p><strong>cache_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – The root directory for caching results. If None, caching is disabled.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.actmax_cache">
<span class="sig-name descname"><span class="pre">actmax_cache</span></span><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.actmax_cache" title="Link to this definition">¶</a></dt>
<dd><p>An object that manages the collection and caching of top activations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache" title="semanticlens.component_visualization.activation_caching.ActMaxCache">ActMaxCache</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any layer name in <cite>layer_names</cite> is not found in the model.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">resnet18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">TensorDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">semanticlens.component_visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActivationComponentVisualizer</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1. Prepare model and dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;resnet18&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_data</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dummy_data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dummy_data&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2. Initialize the visualizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">visualizer</span> <span class="o">=</span> <span class="n">ActivationComponentVisualizer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dataset_model</span><span class="o">=</span><span class="n">dummy_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dataset_fm</span><span class="o">=</span><span class="n">dummy_data</span><span class="p">,</span> <span class="c1"># Using same dataset for simplicity here</span>
<span class="gp">... </span>    <span class="n">layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;layer4.1.conv2&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cache_dir</span><span class="o">=</span><span class="s2">&quot;./cache&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3. Run the analysis to find top-activating samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will process the dataset and save the results to the cache.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># visualizer.run(batch_size=32)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.AGGREGATION_DEFAULTS">
<span class="sig-name descname"><span class="pre">AGGREGATION_DEFAULTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'max':</span> <span class="pre">&lt;function</span> <span class="pre">aggregate_conv_max&gt;,</span> <span class="pre">'mean':</span> <span class="pre">&lt;function</span> <span class="pre">aggregate_conv_mean&gt;}</span></em><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.AGGREGATION_DEFAULTS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the ActivationComponentVisualizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><em>torch.nn.Module</em></a>) – The neural network model to analyze.</p></li>
<li><p><strong>dataset_model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – Dataset for model inference and activation collection.</p></li>
<li><p><strong>dataset_fm</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – Dataset preprocessed for foundation model encoding.</p></li>
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Names of the layers to analyze for component visualization.</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of top activating samples to collect per component.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Device for computations. If None, uses model’s device.</p></li>
<li><p><strong>aggregate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function for aggregating activations. If None, uses default conv mean aggregation.</p></li>
<li><p><strong>cache_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Directory for caching results. If None, results will not be cached.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any layer in layer_names is not found in the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.caching">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">caching</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.caching" title="Link to this definition">¶</a></dt>
<dd><p>Check if caching is enabled.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.device" title="Link to this definition">¶</a></dt>
<dd><p>Get the device of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device where the model parameters are located.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)">torch.device</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.get_max_reference">
<span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.get_max_reference" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating samples for a layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer to get sample IDs for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape (n_components, n_samples) containing the dataset
indices of maximally activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Get metadata about the visualization instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing metadata about the cache, dataset, and model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the activation maximization analysis on the dataset.</p>
<p>This method processes the entire <cite>dataset_model</cite> to find the maximally
activating input examples for each component in the specified layers.
If a valid cache is found, the results are loaded directly from disk,
skipping the computation. Otherwise, the computation is performed and
the results are saved to the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=32</em>) – The batch size to use for processing the dataset.</p></li>
<li><p><strong>num_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – The number of worker processes for the data loader.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping layer names to <cite>ActMax</cite> instances, which
contain the top activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.storage_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storage_dir</span></span><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.storage_dir" title="Link to this definition">¶</a></dt>
<dd><p>Get the directory for storing concept visualization cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the storage directory for this visualizer instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)">pathlib.Path</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If no cache directory was provided during initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.to" title="Link to this definition">¶</a></dt>
<dd><p>Move the model to the specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The target device to move the model to.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model after being moved to the specified device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)">torch.nn.Module</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.ActivationComponentVisualizer.visualize_components">
<span class="sig-name descname"><span class="pre">visualize_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denormalization_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/activation_based.html#ActivationComponentVisualizer.visualize_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.ActivationComponentVisualizer.visualize_components" title="Link to this definition">¶</a></dt>
<dd><p>Visualize specific components by displaying their top activating samples.</p>
<p>A good place to put it here since we need access to the PIL-dataset and actmax cache to implement this. However we should call a stateless function in here that abstracts complexity and can be used by other versions of the concept visualizer as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component_ids</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – IDs of the components to visualize.</p></li>
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer containing the components.</p></li>
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=9</em>) – Number of top activating samples to display per component.</p></li>
<li><p><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=3</em>) – Number of rows in the grid layout for each component.</p></li>
<li><p><strong>denormalization_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function to denormalize the images before visualization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">semanticlens.component_visualization.</span></span><span class="sig-name descname"><span class="pre">RelevanceComponentVisualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_fn='sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_norm=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dir='FeatureVisualization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fn=&lt;function</span> <span class="pre">crop_and_mask_images&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureVisualization</span></code>, <a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer" title="semanticlens.component_visualization.base.AbstractComponentVisualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponentVisualizer</span></code></a></p>
<p>Component visualizer using relevance-based attribution methods.</p>
<p>This class extends the FeatureVisualization from CRP (Concept Relevance Propagation)
to provide relevance-based analysis of neural network components. It uses attribution
methods like LRP to understand which input features contribute most to specific
neural activations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribution</strong> (<em>crp.attribution.Attributor</em>) – Attribution method for computing relevance scores.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.8)"><em>torch.utils.data.Dataset</em></a>) – Dataset containing input examples for analysis.</p></li>
<li><p><strong>layer_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Names of the layers to analyze.</p></li>
<li><p><strong>preprocess_fn</strong> (<em>callable</em>) – Function for preprocessing input data.</p></li>
<li><p><strong>composite</strong> (<em>zennit.composites.Composite</em><em>, </em><em>optional</em>) – Composite rule for attribution computation.</p></li>
<li><p><strong>aggregation_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;sum&quot;</em>) – Function for aggregating relevance scores.</p></li>
<li><p><strong>abs_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – Whether to use absolute normalization.</p></li>
<li><p><strong>storage_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;FeatureVisualization&quot;</em>) – Directory for storing visualization results.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Device for computations.</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=100</em>) – Number of samples to analyze per component.</p></li>
<li><p><strong>cache</strong> (<em>optional</em>) – Caching configuration.</p></li>
<li><p><strong>plot_fn</strong> (<em>callable</em><em>, </em><em>default=crop_and_mask_images</em>) – Function for plotting/rendering visualizations.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.num_samples">
<span class="sig-name descname"><span class="pre">num_samples</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.num_samples" title="Link to this definition">¶</a></dt>
<dd><p>Number of samples per component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.composite">
<span class="sig-name descname"><span class="pre">composite</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.composite" title="Link to this definition">¶</a></dt>
<dd><p>Composite rule for attribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>zennit.composites.Composite</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.storage_dir">
<span class="sig-name descname"><span class="pre">storage_dir</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.storage_dir" title="Link to this definition">¶</a></dt>
<dd><p>Storage directory path.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.plot_fn">
<span class="sig-name descname"><span class="pre">plot_fn</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.plot_fn" title="Link to this definition">¶</a></dt>
<dd><p>Plotting function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.aggregation_fn">
<span class="sig-name descname"><span class="pre">aggregation_fn</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.aggregation_fn" title="Link to this definition">¶</a></dt>
<dd><p>Aggregation function name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.abs_norm">
<span class="sig-name descname"><span class="pre">abs_norm</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.abs_norm" title="Link to this definition">¶</a></dt>
<dd><p>Whether absolute normalization is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.ActMax">
<span class="sig-name descname"><span class="pre">ActMax</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.ActMax" title="Link to this definition">¶</a></dt>
<dd><p>Maximization handler for activation analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>crp.maximization.Maximization</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.ActStats">
<span class="sig-name descname"><span class="pre">ActStats</span></span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.ActStats" title="Link to this definition">¶</a></dt>
<dd><p>Statistics handler for activation analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>crp.statistics.Statistics</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composite=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_start=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_end=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint=500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">\*\*kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.run" title="Link to this definition">¶</a></dt>
<dd><p>Run relevance-based preprocessing and analysis.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.get_max_reference">
<span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concept_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.get_max_reference" title="Link to this definition">¶</a></dt>
<dd><p>Get reference examples using relevance attribution.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.check_if_preprocessed">
<span class="sig-name descname"><span class="pre">check_if_preprocessed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.check_if_preprocessed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.check_if_preprocessed" title="Link to this definition">¶</a></dt>
<dd><p>Check if preprocessing has been completed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.get_act_max_sample_ids">
<span class="sig-name descname"><span class="pre">get_act_max_sample_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_act_max_sample_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.get_act_max_sample_ids" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating examples.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.to" title="Link to this definition">¶</a></dt>
<dd><p>Move visualizer to specified device.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.Properties">
<span class="sig-name descname"><span class="pre">Properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.Properties" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">----------</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">metadata</span> <span class="pre">:</span> <span class="pre">dict</span></span></dt>
<dd><p>Metadata about the visualizer configuration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_fn='sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_norm=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dir='FeatureVisualization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fn=&lt;function</span> <span class="pre">crop_and_mask_images&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">check_if_preprocessed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.check_if_preprocessed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition">¶</a></dt>
<dd><p>Check if preprocessing has been completed for all layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if all specified layers have been preprocessed, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">get_act_max_sample_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_act_max_sample_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition">¶</a></dt>
<dd><p>Get sample IDs of maximally activating examples for a layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer to get sample IDs for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape (n_components, n_samples) containing the dataset
indices of maximally activating samples for each component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">get_max_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concept_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.get_max_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition">¶</a></dt>
<dd><p>Get reference examples using relevance attribution.</p>
<p>Computes relevance-based visualizations for specified concepts using
attribution methods to highlight the most relevant input features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concept_ids</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – IDs of concepts to visualize.</p></li>
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the layer containing the concepts.</p></li>
<li><p><strong>n_ref</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of reference examples to generate.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=32</em>) – Batch size for processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping concept IDs to their reference visualizations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.13)"><strong>AttributeError</strong></a> – If gradients are not enabled or CRP requirements are not met.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method requires gradients to be enabled for LRP/CRP computation.
The <cite>torch.enable_grad()</cite> decorator ensures this requirement is met.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="semanticlens.component_visualization.RelevanceComponentVisualizer.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></em><a class="headerlink" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Get metadata about the visualizer configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing configuration parameters for caching and
reproducibility, including preprocessing function, normalization
settings, aggregation function, storage directory, device,
number of samples, and plotting function.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition">¶</a></dt>
<dd><p>Run relevance-based preprocessing and analysis.</p>
<p>Processes the dataset using attribution methods to compute relevance
scores and identify maximally activating examples for each component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>composite</strong> (<em>zennit.composites.Composite</em><em>, </em><em>optional</em>) – Composite rule for attribution computation. If None, uses the
composite from initialization.</p></li>
<li><p><strong>data_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Starting index in the dataset.</p></li>
<li><p><strong>data_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Ending index in the dataset. If None, processes entire dataset.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=32</em>) – Batch size for processing.</p></li>
<li><p><strong>checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=500</em>) – Interval for saving checkpoints during processing.</p></li>
<li><p><strong>on_device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Device for computation.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to parent run method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Results from preprocessing, or list of existing files if already preprocessed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a> or other</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/semanticlens/component_visualization/relevance_based.html#RelevanceComponentVisualizer.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition">¶</a></dt>
<dd><p>Move visualizer and attribution model to specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>torch.device</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Target device for the visualizer and attribution model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="semanticlens.foundation_models.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">semanticlens.foundation_models package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="semanticlens.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">semanticlens package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Jim Berend
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Aug 18, 2025</div>
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/jim-berend/semanticlens" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              <a class="muted-link " href="https://pypi.org/project/semanticlens/" aria-label="PyPI">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">semanticlens.component_visualization package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-semanticlens.component_visualization.activation_based">semanticlens.component_visualization.activation_based module</a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.actmax_cache"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.actmax_cache</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.AGGREGATION_DEFAULTS"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.AGGREGATION_DEFAULTS</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.__init__"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.caching"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.caching</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.device"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.device</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.get_max_reference"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.metadata"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.metadata</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.run"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.storage_dir"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.storage_dir</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.to"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.to()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.ActivationComponentVisualizer.visualize_components"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.visualize_components()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_based.MissingNameWarning"><code class="docutils literal notranslate"><span class="pre">MissingNameWarning</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-semanticlens.component_visualization.activation_caching">semanticlens.component_visualization.activation_caching module</a><ul>
<li><a class="reference internal" href="#workflow-example">Workflow Example</a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache"><code class="docutils literal notranslate"><span class="pre">ActCache</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache.layer_names"><code class="docutils literal notranslate"><span class="pre">ActCache.layer_names</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache.cache"><code class="docutils literal notranslate"><span class="pre">ActCache.cache</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache.handles"><code class="docutils literal notranslate"><span class="pre">ActCache.handles</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache.__init__"><code class="docutils literal notranslate"><span class="pre">ActCache.__init__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActCache.hook_context"><code class="docutils literal notranslate"><span class="pre">ActCache.hook_context()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax"><code class="docutils literal notranslate"><span class="pre">ActMax</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.n_collect"><code class="docutils literal notranslate"><span class="pre">ActMax.n_collect</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.n_latents"><code class="docutils literal notranslate"><span class="pre">ActMax.n_latents</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.is_setup"><code class="docutils literal notranslate"><span class="pre">ActMax.is_setup</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.activations"><code class="docutils literal notranslate"><span class="pre">ActMax.activations</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.sample_ids"><code class="docutils literal notranslate"><span class="pre">ActMax.sample_ids</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.__init__"><code class="docutils literal notranslate"><span class="pre">ActMax.__init__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.alive_latents"><code class="docutils literal notranslate"><span class="pre">ActMax.alive_latents</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.load"><code class="docutils literal notranslate"><span class="pre">ActMax.load()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.store"><code class="docutils literal notranslate"><span class="pre">ActMax.store()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMax.update"><code class="docutils literal notranslate"><span class="pre">ActMax.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache"><code class="docutils literal notranslate"><span class="pre">ActMaxCache</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.aggregation_fn"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.aggregation_fn</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.n_collect"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.n_collect</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.sample_idx_counter"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.sample_idx_counter</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.agg_fn_name"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.agg_fn_name</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.cache"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.cache</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__getitem__"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.__getitem__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__init__"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.__init__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__iter__"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.__iter__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.__repr__"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.__repr__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.load"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.load()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.metadata"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.metadata</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.activation_caching.ActMaxCache.store"><code class="docutils literal notranslate"><span class="pre">ActMaxCache.store()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-semanticlens.component_visualization.aggregators">semanticlens.component_visualization.aggregators module</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.aggregate_conv_max"><code class="docutils literal notranslate"><span class="pre">aggregate_conv_max()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.aggregate_conv_mean"><code class="docutils literal notranslate"><span class="pre">aggregate_conv_mean()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_absmax"><code class="docutils literal notranslate"><span class="pre">aggregate_transformer_absmax()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_absmean"><code class="docutils literal notranslate"><span class="pre">aggregate_transformer_absmean()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_max"><code class="docutils literal notranslate"><span class="pre">aggregate_transformer_max()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.aggregate_transformer_mean"><code class="docutils literal notranslate"><span class="pre">aggregate_transformer_mean()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.aggregators.get_aggregate_transformer_special_token"><code class="docutils literal notranslate"><span class="pre">get_aggregate_transformer_special_token()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-semanticlens.component_visualization.base">semanticlens.component_visualization.base module</a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.model"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.model</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.device"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.device</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.__init__"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.caching"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.caching</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.device</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.get_max_reference"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.metadata"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.metadata</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.run"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.storage_dir"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.storage_dir</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.base.AbstractComponentVisualizer.to"><code class="docutils literal notranslate"><span class="pre">AbstractComponentVisualizer.to()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-semanticlens.component_visualization.relevance_based">semanticlens.component_visualization.relevance_based module</a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.num_samples"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.num_samples</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.composite"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.composite</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.storage_dir"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.storage_dir</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.plot_fn"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.plot_fn</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.aggregation_fn"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.aggregation_fn</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.abs_norm"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.abs_norm</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.ActMax"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.ActMax</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.ActStats"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.ActStats</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.run"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.get_max_reference"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.check_if_preprocessed"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.check_if_preprocessed()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.get_act_max_sample_ids"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_act_max_sample_ids()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.to"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.to()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.Properties"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.Properties()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.__init__"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.check_if_preprocessed()</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_act_max_sample_ids()</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.relevance_based.RelevanceComponentVisualizer.metadata"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.metadata</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.to()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-semanticlens.component_visualization">Module contents</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.actmax_cache"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.actmax_cache</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.AGGREGATION_DEFAULTS"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.AGGREGATION_DEFAULTS</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.__init__"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.caching"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.caching</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.device"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.device</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.get_max_reference"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.metadata"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.metadata</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.run"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.storage_dir"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.storage_dir</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.to"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.to()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.ActivationComponentVisualizer.visualize_components"><code class="docutils literal notranslate"><span class="pre">ActivationComponentVisualizer.visualize_components()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer</span></code></a><ul>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.num_samples"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.num_samples</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.composite"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.composite</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.storage_dir"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.storage_dir</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.plot_fn"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.plot_fn</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.aggregation_fn"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.aggregation_fn</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.abs_norm"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.abs_norm</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.ActMax"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.ActMax</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.ActStats"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.ActStats</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.run"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.get_max_reference"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.check_if_preprocessed"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.check_if_preprocessed()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.get_act_max_sample_ids"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_act_max_sample_ids()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.to"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.to()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.Properties"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.Properties()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.__init__"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.check_if_preprocessed()</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_act_max_sample_ids()</span></code></a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.get_max_reference()</span></code></a></li>
<li><a class="reference internal" href="#semanticlens.component_visualization.RelevanceComponentVisualizer.metadata"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.metadata</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.run()</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">RelevanceComponentVisualizer.to()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=92734c54"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>